name: 'Check PR Trigger'
description: 'Determine if a PR should be created or closed based on file or commit'
outputs:
  action:
    description: 'Action to take: create, close, or skip'
    value: '${{ steps.check.outputs.action }}'
runs:
  using: 'composite'
  steps:
    - name: Check File and Commit
      id: check
      run: |
        COMMIT_MSG=$(git log -1 --pretty=%s)
        echo "DEBUG: Checking commit message: '$COMMIT_MSG'"
        if [ -f "pull_request.json" ] && jq -e .title "pull_request.json" >/dev/null 2>&1; then
          echo "Action: create PR (file-based)"
          echo "action=create" >> $GITHUB_OUTPUT
        elif echo "$COMMIT_MSG" | grep -qE "^close-pr$"; then
          echo "Action: close PR"
          echo "action=close" >> $GITHUB_OUTPUT
        else
          echo "Action: skip (no PR action needed)"
          echo "action=skip" >> $GITHUB_OUTPUT
        fi
      shell: bash